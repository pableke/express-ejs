function MessageBox(){const e=this,t="",r=".",n={en:{lang:"en",errForm:"Form validation failed",errRequired:"Required field!",errMinlength8:"The minimum required length is 8 characters",errNif:"Wrong ID format",errCorreo:"Wrong Mail format",errDate:"Wrong date format",errDateLe:"Date must be less or equals than current",errDateGe:"Date must be greater or equals than current",errNumber:"Wrong number format",errGt0:"Price must be great than 0.00 &euro;",errRegex:"Wrong format",errReclave:"Passwords typed do not match",errRange:"Value out of allowed range",remove:"Are you sure to delete element?",cancel:"Are you sure to cancel element?",decimals:r,dateHelper:function(e){return e&&e.replace(/^(\d{4})(\d+)$/g,"$1-$2").replace(/^(\d{4}\-\d\d)(\d+)$/g,"$1-$2").replace(/[^\d\-]/g,t)},timeHelper:function(e){return e&&e.replace(/(\d\d)(\d+)$/g,"$1:$2").replace(/[^\d\:]/g,t)},floatHelper:function(e,t){return e&&a(e,",",r,2)}},es:{lang:"es",errForm:"Error al validar los campos del formulario",errRequired:"Campo obligatorio!",errMinlength8:"La longitud mínima requerida es de 8 caracteres",errNif:"Formato de NIF / CIF incorrecto",errCorreo:"Formato de E-Mail incorrecto",errDate:"Formato de fecha incorrecto",errDateLe:"La fecha debe ser menor o igual a la actual",errDateGe:"La fecha debe ser mayor o igual a la actual",errNumber:"Valor no numérico",errGt0:"El importe debe ser mayor de 0,00 &euro;",errRegex:"Formato incorrecto",errReclave:"Las claves introducidas no coinciden",errRange:"Valor fuera del rango permitido",remove:"¿Confirma que desea eliminar este registro?",cancel:"¿Confirma que desea cancelar este registro?",decimals:",",dateHelper:function(e){return e&&e.replace(/^(\d\d)(\d+)$/g,"$1/$2").replace(/^(\d\d\/\d\d)(\d+)$/g,"$1/$2").replace(/[^\d\/]/g,t)},timeHelper:function(e){return e&&e.replace(/(\d\d)(\d+)$/g,"$1:$2").replace(/[^\d\:]/g,t)},floatHelper:function(e,t){return e&&a(e,r,",",2)}}};let i=n.es;function a(e,n,a,o){let s=e.lastIndexOf(i.decimals),u="-"==e.charAt(0)?"-":t,l=(s<0?e:e.substr(0,s)).replace(/\D+/g,t).replace(/^0+/,t),c=s<0?t:e.substr(s+1),d=parseFloat(u+l+r+c);return isNaN(d)?e:u+function(e,t){for(var r=[],n=e.length;n>t;n-=t)r.unshift(e.substr(n-t,t));return n>0&&r.unshift(e.substr(0,n)),r}(l,3).join(n)+a+(s<0?"0".repeat(o):c.padEnd(o,"0"))}this.getLang=function(e){return e?n[e]:i},this.setLang=function(t,r){return n[t]=r,e},this.getI18n=function(e){return e&&(n[e]||n[e.substr(0,2)])||n.es},this.setI18n=function(t){return i=e.getI18n(t),e},this.get=function(e){return i[e]},this.set=function(t,r){return i[t]=r,e},this.format=function(e){return e.replace(/@(\w+);/g,(e,t)=>nvl(i[t],e))}}function StringBox(){const e=this,t="àáâãäåāăąÀÁÂÃÄÅĀĂĄÆßèéêëēĕėęěÈÉĒĔĖĘĚìíîïìĩīĭÌÍÎÏÌĨĪĬòóôõöōŏőøÒÓÔÕÖŌŎŐØùúûüũūŭůÙÚÛÜŨŪŬŮçÇñÑþÐŔŕÿÝ",r="aaaaaaaaaAAAAAAAAAABeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIoooooooooOOOOOOOOOuuuuuuuuUUUUUUUUcCnNdDRryY";function n(e){return"string"==typeof e||e instanceof String}function i(e){return n(e)?e.trim():e}function a(e){return e?e.length:0}function o(e){for(var n="",o=a(i(e)),s=0;s<o;s++){var u=e.charAt(s),l=t.indexOf(u);n+=l<0?u:r.charAt(l)}return n.toLowerCase()}this.isstr=n,this.trim=i,this.size=a,this.eq=function(e,t){return o(e)==o(t)},this.indexOf=function(e,t){return e?e.indexOf(t):-1},this.iIndexOf=function(e,t){return o(e).indexOf(o(t))},this.prevIndexOf=function(e,t,r){return e?e.substr(0,r).lastIndexOf(t):-1},this.prefix=function(e,t){return e.startsWith(t)?e:t+e},this.suffix=function(e,t){return e.endsWith(t)?e:e+t},this.trunc=function(e,t){return a(e)>t?e.substr(0,t).trim()+"...":e},this.itrunc=function(t,r){var n=a(t)>r?e.prevIndexOf(t," ",r):-1;return e.trunc(t,n<0?r:n)},this.removeAt=function(e,t,r){return t<0?e:e.substr(0,t)+e.substr(t+r)},this.insertAt=function(e,t,r){return e?e.substr(0,r)+t+e.substr(r):t},this.replaceAt=function(e,t,r,n){return r<0?e:e.substr(0,r)+t+e.substr(r+n)},this.replaceLast=function(e,t,r){return e?e.replaceAt(e.lastIndexOf(t),t.length,r):r},this.wrapAt=function(t,r,n,i,a){return r<0?t:e.insertAt(e.insertAt(t,i,r),a,r+i.length+n)},this.iwrap=function(t,r,n,i){return t&&r&&e.wrapAt(t,e.iIndexOf(t,r),r.length,n||"<u><b>",i||"</b></u>")},this.rand=function(e){return Math.random().toString(36).substr(2,e||8)},this.lopd=function(e){return e?"***"+e.substr(3,4)+"**":e},this.split=function(e,t){return e?e.trim().split(t||","):[]},this.minify=function(e){return e?e.trim().replace(/\s{2}/g,""):e},this.lines=function(t){return e.split(t,/[\n\r]+/)},this.words=function(t){return e.split(t,/\s+/)},this.ilike=function(t,r){return e.iIndexOf(""+t,r)>-1},this.olike=function(t,r,n){return r.some(function(r){return e.ilike(t[r],n)})},this.alike=function(t,r,n){return e.words(n).some(function(n){return e.olike(t,r,n)})},this.ltr=function(e,t){for(var r=[],n=a(e);n>t;n-=t)r.unshift(e.substr(n-t,t));return n>0&&r.unshift(e.substr(0,n)),r},this.rtl=function(e,t){for(var r=[],n=a(e),i=0;i<n;i+=t)r.push(e.substr(i,t));return r},this.slices=function(e,t){var r=0,n=[],i=a(e);for(let a=0;r<i&&a<t.length;a++){let i=t[a];n.push(e.substr(r,i)),r+=i}return r<i&&n.push(e.substr(r)),n}}function ValidatorBox(){const e=this,t={},r={},n={},i="",a=/^\d+$/,o=/\D+/g,s=/^\d+(,\d+)*$/,u=/\w+[^\s@]+@[^\s@]+\.[^\s@]+/,l=/^[\w#@&°!§%;:=\^\/\(\)\?\*\+\~\.\,\-\$]{8,}$/,c=/^(\d{8})([A-Z])$/,d=/^([ABCDEFGHJKLMNPQRSUVW])(\d{7})([0-9A-J])$/,f=/^[XYZ]\d{7,8}[A-Z]$/;function h(e){return e?e.length:0}function g(e){return e?e.trim():e}function m(e){return e?e.trim().replace(/\W+/g,i).toUpperCase():e}function v(e,t,r,n){e.setFullYear(+t,+r-1,+n)}function p(e,t,r,n,i){e.setHours(+t||0,+r||0,+n||0,+i||0)}this.size=function(e,t,r){let n=h(e);return t<=n&&n<=r},this.regex=function(e,t){try{return e.test(t)}catch(e){}return!1},this.login=function(t,r){return e.regex(l,r)},this.digits=function(t,r){return e.regex(a,r)},this.idlist=function(t,r){return e.regex(s,r)},this.email=function(t,r,n){return e.regex(u,r)&&e.setData(t,r.toLowerCase())},this.date=function(t,r,n){let i=r&&r.split(o);if(i[0]&&i[1]&&i[2]){let r=new Date;return"en"==n.lang?v(r,i[0],i[1],i[2]):v(r,i[2],i[1],i[0]),p(r,i[3],i[4],i[5],i[6]),!isNaN(r.getTime())&&e.setData(t,r)}return!1},this.time=function(t,r,n){let i=r&&r.split(o);if(i[0]&&i[1]){let r=new Date;return p(r,i[0],i[1],i[2],i[3]),!isNaN(r.getTime())&&e.setData(t,r)}return!1},this.float=function(t,r,n){if(r){let a=r.lastIndexOf(n.decimals),s="-"==r.charAt(0)?"-":i,u=a<0?r:r.substr(0,a),l=a<0?i:"."+r.substring(a+1),c=parseFloat(s+u.replace(o,i)+l);return!isNaN(c)&&e.setData(t,c)}return!1},this.idES=function(t,r){if(r=m(r)){if(e.regex(c,r))return e.dni(t,r);if(e.regex(d,r))return e.cif(t,r);if(e.regex(f,r))return e.nie(t,r)}return!1},this.dni=function(t,r){e.setData(t,r);return"TRWAGMYFPDXBNJZSQVHLCKE".charAt(parseInt(r,10)%23)==r.charAt(8)},this.cif=function(t,r){e.setData(t,r);for(var n=r.match(d),i=n[1],a=n[2],o=n[3],s=0,u=0;u<a.length;u++){var l=parseInt(a[u],10);u%2==0&&(l=(l*=2)<10?l:parseInt(l/10)+l%10),s+=l}var c=0!==(s%=10)?10-s:s,f="JABCDEFGHI".substr(c,1);return i.match(/[ABEH]/)?o==c:i.match(/[KPQS]/)?o==f:o==c||o==f},this.nie=function(t,r){var n=r.charAt(0),i="X"==n?0:"Y"==n?1:"Z"==n?2:n;return e.dni(i+r.substr(1))},this.iban=function(t,r){if(24!=h(r=m(r)))return!1;e.setData(t,r);const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";let a=n.search(r.substring(0,1))+10,o=n.search(r.substring(1,2))+10,s=String(a)+String(o)+r.substring(2);s=s.substring(6)+s.substring(0,6);let u=i,l=Math.ceil(s.length/7);for(let e=1;e<=l;e++)u=String(parseFloat(u+s.substr(7*(e-1),7))%97);return 1==u},this.creditCardNumber=function(t,r){if(16!=h(r=m(r)))return!1;e.setData(t,r);let n=0,a=!1;r=r.trim().replace(/\s+/g,i);for(let e=15;e>=0;e--){let t=+r[e];a&&(t*=2,t-=t>9?9:0),n+=t,a=!a}return n%10==0},this.generatePassword=function(e,t){return t=t||"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_#@&°!§%;:=^/()?*+~.,-$",Array.apply(null,Array(e||10)).map(function(){return t.charAt(Math.random()*t.length)}).join(i)},this.testPassword=function(e){let t=0;return t+=/[A-Z]+/.test(e)?1:0,t+=/[a-z]+/.test(e)?1:0,t+=/[0-9]+/.test(e)?1:0,t+=/[\W]+/.test(e)?1:0,t+=t>2&&h(e)>8},this.get=function(t){return e[t]},this.set=function(t,r){return e[t]=r,e},this.getErrors=function(){return t},this.getError=function(e){return t[e]},this.addMsg=function(r,n){return t[r]=n,e},this.setError=function(r,n){return t.num++,e.addMsg(r,n)},this.getForm=function(e){return r[e]},this.setForm=function(t,n){return r[t]=n,e},this.setForms=function(t){return Object.assign(r,t),e},this.getFields=function(t){let r=e.getForm(t);return r?Object.keys(r):[]},this.getData=function(e){return e?n[e]:n},this.setData=function(t,r){return n[t]=r,e},this.values=function(e,t){t=t||{};let r=h(e);for(let n=0;n<r;n++){let r=e[n];r.name&&(t[r.name]=g(r.value))}return t},this.fails=function(){return t.num>0},this.isValid=function(){return 0==t.num},this.validate=function(r,i,a){for(let e in t)delete t[e];t.num=0;for(let e in n)delete n[e];let o=e.getForm(r);if(o)for(let e in o){let t=o[e];n[e]=g(i[e]),t(e,n[e],a,i)}return e.isValid()}}$(document).ready(function(){const e=$("html").attr("lang"),t=i18n.setI18n(e).getLang(),r=new StringBox;function n(e){e.parentNode.classList.add("d-none")}function i(e){e.parentNode.classList.remove("d-none")}function a(e,t){e.innerHTML=t,i(e)}let o=document.querySelectorAll(".alert-text");o.forEach(e=>{e.firstChild?i(e):n(e)});let s=document.querySelectorAll(".alert-close");function u(e){e&&a(o[0],e)}function l(e){e&&a(o[2],e)}function c(e){e&&a(o[3],e)}function d(){s.forEach(e=>{e.click()})}s.forEach(e=>{e.addEventListener("click",function(){n(e)})});let f=document.querySelector(".loading");function h(){$(f).show(),d()}function g(){$(f).fadeOut()}function m(e){return e?"addClass":"removeClass"}function v(e,t){let r=e.dataset.dest;r?($(r).html(t),u(e.dataset.msg)):u(t)}$(document).on("input",".clearable",function(){$(this)[m(this.value)]("x")}).on("mousemove",".x",function(e){$(this)[m(this.offsetWidth-28<e.clientX-this.getBoundingClientRect().left)]("onX")}).on("touchstart click",".onX",function(e){e.preventDefault(),$(this).removeClass("x onX").val("").change()}),$("a.ajax").click(function(e){let r=this;if(e.preventDefault(),r.classList.contains("remove")&&!confirm(t.remove))return!1;function n(e){return v(r,e)}h(),fetch(r.href).then(e=>e.text().then(e.ok?n:c)).catch(c).finally(g)});let p=document.querySelectorAll("form");for(let e=p.length-1;e>-1;e--){const n="input-error",i=".msg-error",s="textarea[maxlength]";let f=p[e],m=f.elements;function b(){$("#counter-"+this.id,f).text(Math.abs(this.getAttribute("maxlength")-r.size(this.value)))}function D(){$(m).filter(":not([type=hidden])[tabindex]:not([readonly])").first().focus()}function E(){$(m).removeClass(n).siblings(i).text(""),$(m).filter(s).each(b),d(),D()}function x(e){return e.nif+" - "+e.nombre}function A(e,t,r){return!$(e).val(r).siblings("[type=hidden]").val(t)}$(m).filter(".float").change(function(){this.value=t.floatHelper(this.value)}),$(m).filter(".date").keyup(function(){this.value=t.dateHelper(this.value)}),$(m).filter(".time").keyup(function(){this.value=t.timeHelper(this.value)}),$(m).filter(s).keyup(b).each(b),$(m).filter(".ac-user").autocomplete({minLength:3,source:function(e,t){h(),this.element.autocomplete("instance")._renderItem=function(t,n){let i=r.iwrap(x(n),e.term);return $("<li></li>").append("<div>"+i+"</div>").appendTo(t)},fetch("/usuarios.html?term="+e.term).then(e=>e.json()).then(e=>{t(e.slice(0,10))}).catch(c).finally(g)},focus:function(){return!1},select:function(e,t){return A(this,t.item.nif,x(t.item))}}).change(function(e){this.value||A(this,"","")}),$(m).filter("[type=reset]").click(e=>{f.reset(),E()}),D(),f.addEventListener("submit",function(e){function s(e){$(m).val(""),E(),v(f,e)}function d(e){E();for(let t=r.size(m)-1;t>-1;t--){let r=m[t],a=r.name&&e[r.name];a&&$(r).focus().addClass(n).siblings(i).html(a)}var t;u(e.msgOk),(t=e.msgInfo)&&a(o[1],t),l(e.msgWarn),c(e.msgError)}let p=valid.values(m);if(!valid.validate(f.getAttribute("action"),p,t))return d(valid.addMsg("msgError",t.errForm).getErrors()),e.preventDefault();if(!f.classList.contains("ajax"))return!0;h();let b=new FormData(f);fetch(f.action,{method:f.method,body:"multipart/form-data"===f.enctype?b:new URLSearchParams(b),headers:{"Content-Type":f.enctype||"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"}}).then(e=>e.ok?e.text().then(s):e.json().then(d)).catch(c).finally(g),e.preventDefault()})}}),$(document).ready(function(){$("ul.menu").each(function(e,t){$(t.children).filter("[parent][parent!='']").each((e,r)=>{let n=$("#"+$(r).attr("parent"),t);n.children().last().is(t.tagName)||n.append('<ul class="sub-menu"></ul>').children("a").append('<b class="nav-tri">&rtrif;</b>'),n.children().last().append(r)}),$(t.children).remove("[parent][parent!='']"),t.querySelectorAll("i").forEach(e=>{e.classList.length<=1&&e.parentNode.removeChild(e)});let r=$("b.nav-tri",t);r.parent().click(function(e){$(this.parentNode).toggleClass("active"),e.preventDefault()}),$("li",t).hover(function(){r.html("&rtrif;"),$(this).children("a").find("b.nav-tri").html("&dtrif;"),$(this).parents("ul.sub-menu").prev().find("b.nav-tri").html("&dtrif;")}),$("[disabled]",t).each(function(){let e=parseInt(this.getAttribute("disabled"))||0;$(this).toggleClass("disabled",3!=(3&e))}).removeAttr("disabled")}).children().fadeIn(200),$(".sidebar-toggle").click(e=>{$("#sidebar").toggleClass("active"),$(".sidebar-icon",this.parentNode).toggleClass("d-none"),e.preventDefault()});let e=$(".menu-toggle").click(t=>{t.preventDefault(),e.toggleClass("d-none"),$("#wrapper").toggleClass("toggled")}),t=$("#back-to-top").click(function(){return!$("body,html").animate({scrollTop:0},400)});$(window).scroll(function(){$(this).scrollTop()>50?t.fadeIn():t.fadeOut()}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();try{document.querySelector(this.href).scrollIntoView({behavior:"smooth"})}catch(e){}})})}),document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll("#progressbar li"),t=0;document.querySelectorAll(".next-tab").forEach(r=>{r.addEventListener("click",r=>(t<e.length-1&&e[++t].classList.add("active"),!1))}),$(".prev-tab").click(function(){return t&&e[t--].classList.remove("active"),!1}),$("a[href^='#tab-']").click(function(){let r=+this.href.substr(this.href.lastIndexOf("-")+1);return 0<=r&&r!=t&&r<e.length&&(e.forEach((e,t)=>{e.classList.toggle("active",t<=r)}),t=r),!1})});const i18n=new MessageBox,valid=new ValidatorBox;function toISODateString(e){return e.toISOString().substring(0,10)}valid.set("required",function(e,t,r){return valid.size(t,1,200)||!valid.setError(e,r.errRequired)}).set("min8",function(e,t,r){return valid.size(t,8,200)||!valid.setError(e,r.errMinlength8)}).set("usuario",function(e,t,r){return valid.min8(e,t,r)&&(valid.idES(e,t)||valid.email(e,t)||!valid.setError(e,r.errRegex))}).set("clave",function(e,t,r){return valid.min8(e,t,r)&&(valid.login(e,t)||!valid.setError(e,r.errRegex))}).set("reclave",function(e,t,r,n){return valid.clave(e,t,r)&&(t==n.clave||!valid.setError(e,r.errReclave))}).set("nif",function(e,t,r){return valid.required(e,t,r)&&(valid.idES(e,t)||!valid.setError(e,r.errNif))}).set("correo",function(e,t,r){return valid.required(e,t,r)&&(valid.email(e,t)||!valid.setError(e,r.errCorreo))}).set("ltNow",function(e,t,r){return valid.required(e,t,r)&&(valid.date(e,t,r)||!valid.setError(e,r.errDate))&&(valid.getData(e).getTime()<Date.now()||!valid.setError(e,r.errDateLe))}).set("leToday",function(e,t,r){return valid.required(e,t,r)&&(valid.date(e,t,r)||!valid.setError(e,r.errDate))&&(toISODateString(valid.getData(e))<=toISODateString(new Date)||!valid.setError(e,r.errDateLe))}).set("gtNow",function(e,t,r){return valid.required(e,t,r)&&(valid.date(e,t,r)||!valid.setError(e,r.errDate))&&(valid.getData(e).getTime()>Date.now()||!valid.setError(e,r.errDateGe))}).set("geToday",function(e,t,r){return valid.required(e,t,r)&&(valid.date(e,t,r)||!valid.setError(e,r.errDate))&&(toISODateString(valid.getData(e))>=toISODateString(new Date)||!valid.setError(e,r.errDateGe))}).set("gt0",function(e,t,r){return valid.required(e,t,r)&&(valid.float(e,t,r)||!valid.setError(e,r.errNumber))&&(valid.getData(e)>0||!valid.setError(e,r.errGt0))}).setForm("/login.html",{usuario:valid.usuario,clave:valid.clave}).setForm("/test.html",{nombre:valid.required,correo:valid.correo,date:function(e,t,r){return!t||valid.date(e,t,r)||!valid.setError(e,r.errDate)},number:valid.gt0,asunto:valid.required,info:function(e,t,r){return valid.size(t,1,600)||!valid.setError(e,r.errRequired)}});