function ArrayBox(){const i=this;function s(t){return t?t.length:0}function o(t,e){return t==e?0:t<e?-1:1}this.size=s,this.empty=function(t){return s(t)<1},this.find=function(t,e){return t?t.find(e):null},this.ifind=function(t,e){return t?t.findIndex(e):-1},this.indexOf=function(t,e){return t?t.indexOf(e):-1},this.intersect=function(t,e){return e?t.filter(function(t){return-1<e.indexOf(t)}):[]},this.shuffle=function(t){return t.sort(function(){return.5-Math.random()})},this.unique=function(e,t){return t?e.concat(t.filter(t=>e.indexOf(t)<0)):e},this.swap=function(t,e,n){var r=t[e];return t[e]=t[n],t[n]=r,i},this.eq=function(t,n){return t&&n&&t.every((t,e)=>n[e]==t)},this.push=function(t,e){return t&&t.push(e),i},this.pushAt=function(t,e,n){return t&&t.splice(n,0,e),i},this.pop=function(t){return t&&t.pop(),i},this.popAt=function(t,e){return t&&t.splice(e,1),i},this.remove=function(t,e,n){return t&&t.splice(e,n),i},this.reset=function(t){return t&&t.splice(0),i},this.get=function(t,e){return t?t[e]:null},this.last=function(t){return i.get(t,s(t)-1)},this.clone=function(t){return t?t.slice():[]},this.sort=function(t,e){return t&&t.sort(e||o)},this.sortBy=function(t,n,e){return t&&n?t.sort("desc"==e?function(t,e){return o(e[n],t[n])}:function(t,e){return o(t[n],e[n])}):t},this.multisort=function(t,s,a){return a=a||[],t.sort(function t(e,n,r){var i=s[r=r||0],i="desc"==a[r]?o(n[field],e[field]):o(e[i],n[i]);return 0==i&&++r<s.length?t(e,n,r):i}),i},this.each=function(e,n){var r=s(e);for(let t=0;t<r;t++)n(e[t],t);return i},this.reverse=function(e,n){for(let t=s(e)-1;-1<t;t--)n(e[t],t);return i},this.extract=function(e,n){var r=s(e);for(let t=0;t<r;t++)n(e[t],t)&&e.splice(t--,1);return i},this.flush=function(t,e){e=i.ifind(t,e);return-1<e&&t.splice(e,1),i}}function DateBox(){const u=this,e="",n=new Date,r=/^\d.+$/,i=/\D+/g,s=[31,28,31,30,31,30,31,31,30,31,30,31];function a(t){return t&&t[0]}function o(t){return t&&r.test(t)}function l(t){return t.split(i)}function c(t){return t<10?"0"+t:t}function f(t){var e=t[2];return t[2]=t[0],t[0]=e,t}function d(t,e,n){return Math.min(Math.max(t||0,e),n)}function h(t){return d(t,0,59)}function m(t){return t<100?+(e+parseInt(n.getFullYear()/100)+c(t)):t}function g(t){return 0==(3&t)&&(t%25!=0||0==(15&t))}function v(t,e){return s[e]+(1==e&&g(t))}function p(t){return t&&t.getTime&&!isNaN(t.getTime())}function j(t){return t[0]=m(+t[0]||0),t[1]=d(t[1],1,12),t[2]=d(t[2],1,v(t[0],t[1]-1)),t}function b(t,e,n,r,i){return t.setHours(d(e,0,23),h(n),h(r),i||0),isNaN(t.getTime())?null:t}function y(t){let e=new Date;return t=j(t),e.setFullYear(t[0],t[1]-1,t[2]),b(e,t[3],t[4],t[5],t[6])}function E(t){return a(t)?y(t):null}function D(t){return c(t.getHours())+":"+c(t.getMinutes())}function x(t){return D(t)+":"+c(t.getSeconds())}function A(t){return t.getFullYear()+"-"+c(t.getMonth()+1)+"-"+c(t.getDate())}function I(t){return c(t.getDate())+"/"+c(t.getMonth()+1)+"/"+t.getFullYear()}this.isValid=p,this.build=y,this.sysdate=function(){return n},this.isLeap=function(t){return t&&g(t.getFullYear())},this.getDays=function(t,e){return Math.round(Math.abs((t-e)/864e5))},this.daysInMonth=function(t){return t?v(t.getFullYear(),t.getMonth()):0},this.toArray=function(t){return t?[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()]:[]},this.addDate=function(t,e){return t&&t.setDate(t.getDate()+e),u},this.addHours=function(t,e){return t&&t.setHours(t.getHours()+e),u},this.addMs=function(t,e){return t&&t.setMilliseconds(t.getMilliseconds()+e),u},this.reset=function(t){return t&&t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),u},this.trunc=function(t){return t&&t.setHours(0,0,0,0),u},this.clone=function(t){return new Date((t||n).getTime())},this.getWeek=function(t){t=t||n;var e=new Date(t.getFullYear(),0,1);return Math.ceil((t.getDay()+1+u.getDays(t,e))/7)},this.week=function(t,e){e=e||1;const n=new Date(t,0,1);t=(n.getDay()+6)%7;return n.setDate(n.getDate()+7*e-t),n},this.toWeek=function(t){return t?u.week(+t.substr(0,4),+t.substr(6)):null},this.isoWeek=function(t){return t?t.getFullYear()+"-W"+c(u.getWeek(t)):null},this.diff=function(t,e){if((e=e||n)<t)return u.diff(e,t);const r=u.toArray(e);const i=[0,12,u.daysInMonth(e)-e.getDate()+t.getDate(),24,60,60,1e3];return u.toArray(t).forEach(function t(e,n){r[n]-=e,r[n]<0&&(r[n]+=i[n],t(1,n-1))}),r},this.interval=function(t,e,n,r,i){let s=u.clone(t);i=i||1e3;const a=new Date(s.getTime()+e),o=setInterval(function(){u.addMs(s,i),(!n(s,a)||a<=s)&&(clearInterval(o),r&&r())},i);return u},this.eq=function(t,e){return p(t)&&p(e)&&(e=e,t.getTime()==e.getTime())},this.minTime=function(t){return t?D(t):null},this.isoTime=function(t){return t?x(t):null},this.acTime=function(t){return t&&t.replace(/(\d\d)(\d+)$/g,"$1:$2").replace(/[^\d\:]/g,e)},this.toTime=function(t){t=t&&l(t);return a(t)?b(new Date,t[0],t[1],t[2],t[3]):null},this.fmtTime=function(t){let e=t&&l(t);return a(e)?(e[0]=d(e[0],0,23),e[1]=h(e[1]),e[2]&&(e[2]=h(e[2])),e.map(c).join(":")):null},this.enDate=function(t){return t?E(l(t)):null},this.isoEnDate=function(t){return p(t)?A(t):null},this.isoEnDateTime=function(t){return p(t)?A(t)+" "+x(t):null},this.fmtEnDate=function(t){return o(t)?j(l(t)).map(c).join("-"):null},this.acEnDate=function(t){return t&&t.replace(/^(\d{4})(\d+)$/g,"$1-$2").replace(/^(\d{4}\-\d\d)(\d+)$/g,"$1-$2").replace(/[^\d\-]/g,e)},this.esDate=function(t){return t?E(f(l(t))):null},this.isoEsDate=function(t){return p(t)?I(t):null},this.isoEsDateTime=function(t){return p(t)?I(t)+" "+x(t):null},this.fmtEsDate=function(t){return o(t)?f(j(f(l(t)))).map(c).join("/"):null},this.acEsDate=function(t){return t&&t.replace(/^(\d\d)(\d+)$/g,"$1/$2").replace(/^(\d\d\/\d\d)(\d+)$/g,"$1/$2").replace(/[^\d\/]/g,e)}}function GraphBox(){const o=[];this.graph=function(e,n){return n=Object.assign({id:0,level:0,childnodes:[]},n),o.slice(0),pkName=n.pk||"id",fkName=n.fk||"parent",fnGroup=n.onGroup||fnTrue,n.data=e.filter(t=>!t[fkName]),n.data.forEach(t=>{!function e(n,t,r){if(!(-1<o.indexOf(r))){o.push(r);var i=newNode(t,n.filter(t=>t[fkName]==r),r);return i&&i.data.forEach(t=>{e(n,i,t[pkName])}),i}}(e,n,t[pkName])}),n},this.bfs=function(r,i){o.slice(0),o.push(r.id);for(var t=[r];0<t.length;){let n=t.shift();t=n.childnodes.filter((t,e)=>{return o.indexOf(t.id)<0&&i(r,n,t,e)?o.push(t.id):0}).concat(t)}return r},this.findVertex=function(t,e){return o.slice(0),function e(n,r,i){if(-1<o.indexOf(r.id))return null;o.push(r.id);for(let t=0;!a&&t<r.childnodes.length;t++)var s=r.childnodes[t],a=i(n,r,s,t)?s:e(n,s,i);return a}(t,t,e)}}function I18nBox(){const n=this,r={en:{errForm:"Form validation failed",errRequired:"Required field!",errMinlength8:"The minimum required length is 8 characters",errMaxlength:"Max length exceded",errNif:"Wrong ID format",errCorreo:"Wrong Mail format",errDate:"Wrong date format",errDateLe:"Date must be less or equals than current",errDateGe:"Date must be greater or equals than current",errNumber:"Wrong number format",errGt0:"Price must be great than 0.00 &euro;",errRegex:"Wrong format",errReclave:"Passwords typed do not match",errRange:"Value out of allowed range",errRefCircular:"Circular reference",remove:"Are you sure to delete element?",removeOk:"Element removed successfully!",cancel:"Are you sure to cancel element?",cancelOk:"Element canceled successfully!",unlink:"Are you sure to unlink those elements?",unlinkOk:"Elements unlinked successfully!",linkOk:"Elements linked successfully!",closeText:"close",prevText:"prev",nextText:"next",currentText:"current",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],dateFormat:"yy-mm-dd",firstDay:0,toInt:nb.toInt,isoInt:function(t){return nb.isoInt(t,",")},fmtInt:function(t){return nb.fmtInt(t,",")},toFloat:function(t){return nb.toFloat(t,".")},isoFloat:function(t,e){return nb.isoFloat(t,",",".",e)},fmtFloat:function(t,e){return nb.fmtFloat(t,",",".",e)},toDate:dt.enDate,isoDate:dt.isoEnDate,isoDateTime:dt.isoEnDateTime,fmtDate:dt.fmtEnDate,acDate:dt.acEnDate,toTime:dt.toTime,minTime:dt.minTime,isoTime:dt.isoTime,fmtTime:dt.fmtTime,acTime:dt.acTime,get:function(t,e){return t[e+"_en"]||t[e]}},es:{errForm:"Error al validar los campos del formulario",errRequired:"Campo obligatorio!",errMinlength8:"La longitud mínima requerida es de 8 caracteres",errMaxlength:"Longitud máxima excedida",errNif:"Formato de NIF / CIF incorrecto",errCorreo:"Formato de E-Mail incorrecto",errDate:"Formato de fecha incorrecto",errDateLe:"La fecha debe ser menor o igual a la actual",errDateGe:"La fecha debe ser mayor o igual a la actual",errNumber:"Valor no numérico",errGt0:"El importe debe ser mayor de 0,00 &euro;",errRegex:"Formato incorrecto",errReclave:"Las claves introducidas no coinciden",errRange:"Valor fuera del rango permitido",errRefCircular:"Referencia circular",remove:"¿Confirma que desea eliminar este registro?",removeOk:"Registro eliminado correctamente.",cancel:"¿Confirma que desea cancelar este registro?",cancelOk:"Elemento cancelado correctamente.",unlink:"¿Confirma que desea desasociar estos registros?",unlinkOk:"Registros desasociados correctamente",linkOk:"Registros asociados correctamente.",closeText:"close",prevText:"prev.",nextText:"sig.",currentText:"current",monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],dayNamesShort:["Dom","Lun","Mar","Mié","Juv","Vie","Sáb"],dayNamesMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],dateFormat:"dd/mm/yy",firstDay:1,toInt:nb.toInt,isoInt:function(t){return nb.isoInt(t,".")},fmtInt:function(t){return nb.fmtInt(t,".")},toFloat:function(t){return nb.toFloat(t,",")},isoFloat:function(t,e){return nb.isoFloat(t,".",",",e)},fmtFloat:function(t,e){return nb.fmtFloat(t,".",",",e)},toDate:dt.esDate,isoDate:dt.isoEsDate,isoDateTime:dt.isoEsDateTime,fmtDate:dt.fmtEsDate,acDate:dt.acEsDate,toTime:dt.toTime,minTime:dt.minTime,isoTime:dt.isoTime,fmtTime:dt.fmtTime,acTime:dt.acTime,get:function(t,e){return t[e]}}};let i=r.es;this.getLang=function(t){return t?r[t]:i},this.setLang=function(t,e){return r[t]=e,n},this.addLang=function(t,e){return Object.assign(r[t],e),n},this.getI18n=function(t){return t&&(r[t]||r[t.substr(0,2)])||r.es},this.setI18n=function(t){return i=n.getI18n(t),n},this.get=function(t){return i[t]},this.set=function(t,e){return i[t]=e,n}}function JsBox(){const i=this,e=new Date;let s;function t(t){return t}function n(t){console.log("Log:",t)}function a(t){return t?t.length:0}function o(t){return t&&1===t.nodeType}function u(t){return t?t.split(" "):[]}function l(t,e,n){t.matches(e)&&n.push(t)}function r(t){return t?new Date(t):null}function c(t){return t.toISOString().substr(0,10)}function f(t){return t?c(t):null}let d={toInt:parseInt,isoInt:t,toFloat:parseFloat,isoFloat:t,toDate:r,isoDate:f,toTime:function(t){return t?new Date(c(e)+"T"+t):null},isoTime:function(t){return t?t.toISOString().substr(11,8):null},toWeek:function(t){return t?new Date:null},isoWeek:function(t){return t?t.getFullYear()+"-W01":null}};function h(e,n){var r=a(n);for(let t=0;t<r;t++)if(n[t].matches(e))return t;return-1}function m(e,n,r){for(let t=e.previousElementSibling;t;t=t.previousElementSibling)l(t,n,r)}function g(e,n,r){for(let t=e.nextElementSibling;t;t=t.nextElementSibling)l(t,n,r)}function v(e,n){for(let t=e.previousElementSibling;t;t=t.previousElementSibling)n.push(t)}function p(e,n){for(let t=e.nextElementSibling;t;t=t.nextElementSibling)n.push(t)}function j(t,e){return"SELECT"===t.tagName?(e=e||t.getAttribute("value"),t.selectedIndex=i.findIndex(t=>t.value==e,t.options)):t.value=e,i}this.get=function(t,e){return(e||document).querySelector(t)},this.getAll=function(t,e){return(e||document).querySelectorAll(t)},this.set=function(t){return delete s,s=t,i},this.load=function(t,e){return t?"string"==typeof t||t instanceof String?i.set(i.getAll(t,e)):i.set(t):i},this.getI18n=function(){return d},this.setI18n=function(t){return d=t,i},this.getLang=function(){return document.querySelector("html").getAttribute("lang")||navigator.language||navigator.userLanguage},this.buildPath=function(t,e){e=e||window.location.pathname;let n=new URLSearchParams(t),r=new URLSearchParams(window.location.search);return n.forEach((t,e)=>r.set(e,t)),e+"?"+r.toString()},this.scrollTop=function(t){t=t||600;let e=-window.scrollY/(t/15),n=setInterval(()=>{0<window.scrollY?window.scrollBy(0,e):clearInterval(n)},15);return i},this.fetch=function(r){return(r=r||{}).headers=r.headers||{},r.reject=r.reject||n,r.resolve=r.resolve||n,r.headers["x-requested-with"]="XMLHttpRequest",r.headers.Authorization="Bearer "+window.localStorage.getItem("jwt"),window.fetch(r.action,r).then(t=>{let e=t.headers.get("content-type")||"",n=-1<e.indexOf("application/json")?t.json():t.text();return n.then(t.ok?r.resolve:r.reject)})},this.each=function(e,n){if(o(n=n||s))e(n,0);else{var r=a(n);for(let t=0;t<r;t++)e(n[t],t,n)}return i},this.reverse=function(e,n){if(o(n=n||s))e(n,0);else for(let t=a(n)-1;-1<t;t--)e(n[t],t,n);return i},this.findIndex=function(t,e){return o(e=e||s)?e.matches(t)?0:-1:h(t,e)},this.find=function(t,e){if(o(e=e||s))return e.matches(t)?e:null;t=h(t,e);return t<0?null:e[t]},this.filter=function(e,t){let n=[];return i.each(t=>l(t,e,n),t),n},this.prev=function(e,t){let n=[];return e?i.each(t=>m(t,e,n),t):i.each(t=>v(t,n),t),n},this.next=function(e,t){let n=[];return e?i.each(t=>g(t,e,n),t):i.each(t=>p(t,n),t),n},this.siblings=function(e,t){let n=[];return e?i.each(t=>function(t,e,n){m(t,e,n),g(t,e,n)}(t,e,n),t):i.each(t=>function(t,e){v(t,e),p(t,e)}(t,n),t),n},this.attr=function(e,n,t){return i.each(t=>t.setAttribute(e,n),t)},this.val=function(e,t){return i.each(t=>j(t,e),t)},this.text=function(e,t){return i.each(t=>{t.innerText=e},t)},this.html=function(e,t){return i.each(t=>{t.innerHTML=e},t)},this.replace=function(e,t){return i.each(t=>{t.outerHTML=e},t)},this.focus=function(t){const e=i.find("[tabindex]:not([type=hidden][readonly][disabled]):not([tabindex='-1'][tabindex=''])",t);return e&&e.focus(),i},this.mask=function(n,t){return i.each((t,e)=>0==(n>>e&1)?i.addClass("hide",t):i.removeClass("hide",t),t)},this.select=function(n,t){return i.each(t=>{i.mask(n,t.querySelectorAll("option"));var e=t.querySelector("option[value='"+t.value+"']");i.hasClass("hide",e)&&(t.selectedIndex=i.findIndex("option:not(.hide)",t.children))},t)},this.import=function(t,e){return e?i.each(t=>{t.classList.contains("integer")?t.value=d.isoInt(e[t.name]):t.classList.contains("float")?t.value=d.isoFloat(e[t.name]):"date"==t.type||"month"==t.type?t.value=f(e[t.name]):"week"==t.type?t.value=i18.isoWeek(e[t.name]):t.classList.contains("date")?t.value=d.isoDate(e[t.name]):"time"==t.type||t.classList.contains("time")?t.value=d.isoTime(e[t.name]):j(t,e[t.name])},t):i.val("",t),i},this.export=function(t,e){return e=e||{},i.each(t=>{t.classList.contains("integer")?e[t.name]=d.toInt(t.value):t.classList.contains("float")?e[t.name]=d.toFloat(t.value):"date"==t.type?e[t.name]=r(t.value):"month"==t.type?e[t.name]=t.value?new Date(t.value+"-1"):null:"week"==t.type?e[t.name]=d.toWeek(t.value):t.classList.contains("date")?e[t.name]=d.toDate(t.value):"time"==t.type||t.classList.contains("time")?e[t.name]=d.toTime(t.value):e[t.name]=t.value},t),delete e.undefined,e},this.isVisible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},this.show=function(t,e){return e=e||"block",i.each(t=>{t.style.display=e},t)},this.hide=function(t){return i.each(t=>{t.style.display="none"},t)},this.hasClass=function(t,e){const n=a(e=e||s)?e[0]:e;return n&&u(t).some(t=>n.classList.contains(t))},this.setClass=function(e,t){return i.each(t=>{t.className=e},t)},this.addClass=function(t,e){const n=u(t);return i.each(function(e){n.forEach(t=>e.classList.add(t))},e)},this.removeClass=function(t,e){const n=u(t);return i.each(function(e){n.forEach(t=>e.classList.remove(t))},e)},this.toggle=function(t,n){const r=u(t);return i.each(e=>r.forEach(t=>e.classList.toggle(t,n)))},this.css=function(t,e,n){const r=t.replace(/(-[a-z])/,t=>t.replace("-","").toUpperCase());return i.each(t=>{t.style[r]=e},n)};function b(e,t,n){return e.addEventListener(t,t=>n(e,t)),i}this.fadeOut=function(t){return i.each(function(e){let n=parseFloat(e.style.opacity)||0;!function t(){(n-=.03)<0?e.style.display="none":requestAnimationFrame(t),e.style.opacity=n}()},t)},this.fadeIn=function(t,r){return i.each(function(e){e.style.display=r||"block";let n=parseFloat(e.style.opacity)||0;!function t(){(n+=.03)<1&&requestAnimationFrame(t),e.style.opacity=n}()},t)},this.fadeToggle=function(t,e){var n=a(t)?t[0]:t;return(parseFloat(n&&n.style.opacity)||0)<.03?i.fadeIn(t,e):i.fadeOut(t)},this.ready=function(t){return b(document,"DOMContentLoaded",t)},this.click=function(e,t){return i.each(t=>b(t,"click",e),t)},this.change=function(e,t){return i.each(t=>b(t,"change",e),t)},this.keyup=function(e,t){return i.each(t=>b(t,"keyup",e),t)},this.keydown=function(e,t){return i.each(t=>b(t,"keydown",e),t)},this.submit=function(e,t){return i.each(t=>b(t,"submit",e),t)},this.trigger=function(e,t){return i.each(t=>t.dispatchEvent(new Event(e)),t)}}function NumberBox(){const u=/\D+/g;function i(t){return null!=t}function l(t,e){for(var n=[],r=t.length;e<r;r-=e)n.unshift(t.substr(r-e,e));return 0<r&&n.unshift(t.substr(0,r)),n}function n(t,e){var n="-"==t.charAt(0)?"-":"",t=t.replace(u,"").replace(/^0+(\d+)/,"$1");return t?n+l(t,3).join(e):null}function s(e,n,r,i,s){i=isNaN(i)?2:i;var a=e.lastIndexOf(s),s="-"==e.charAt(0)?"-":"";let o=0<a?e.substr(0,a):e;if(o=0==a?"0":o.replace(u,"").replace(/^0+(\d+)/,"$1"),o){let t=a<0?"0":e.substr(a+1,i);return s+l(o,3).join(n)+r+(a<0?"0".repeat(i):t.padEnd(i,"0"))}return null}this.toInt=function(t){if(!t)return null;var e="-"==t.charAt(0)?"-":"",t=parseInt(e+t.replace(u,""));return isNaN(t)?null:t},this.isoInt=function(t,e){return i(t)?n(""+t,e):null},this.fmtInt=function(t,e){return t&&n(t,e)},this.intval=function(t){return parseInt(t)||0},this.toFloat=function(t,e){if(!t)return null;var n=t.lastIndexOf(e),e="-"==t.charAt(0)?"-":"";let r=n<0?t:t.substr(0,n);n=n<0?"":"."+t.substr(n+1),n=parseFloat(e+r.replace(u,"")+n);return isNaN(n)?null:n},this.isoFloat=function(t,e,n,r){return i(t)?s(""+t,e,n,r,"."):null},this.fmtFloat=function(t,e,n,r){return t&&s(t,e,n,r,n)},this.floatval=function(t){return parseFloat(t)||0}}function ObjectBox(){const i=this;function r(t){return null==t}function s(t){return t&&t.getTime&&!isNaN(t.getTime())}this.isobj=function(t){return t&&"object"==typeof t&&!Array.isArray(t)},this.get=function(t,e){return t&&t[e]},this.set=function(t,e,n){return t[e]=n,i},this.add=function(t,e,n){return t[e]=n,t},this.del=function(t,e){return t&&delete t[e],t},this.flush=function(t,e){return i.del(t,e),i},this.delArray=function(t,e){return t&&(t[e].splice(0),delete t[e]),i},this.flushArray=function(t,e){return i.delArray(t,e),i},this.setArray=function(t,e,n){return i.flushArray(t,e).set(t,e,n)},this.delObject=function(t,e){return i.clear(t),i.del(t,e)},this.flushObject=function(t,e){return i.delObject(t[e],e),i},this.setObject=function(t,e,n){return i.flushObject(t,e).set(t,e,n)},this.eq=function(e,n,t){return t=t||Object.keys(n),e&&t.every(t=>function(t,e){return r(t)&&r(e)||s(t)&&s(e)&&(n=e,t.getTime()==n.getTime())||t==e;var n}(e[t],n[t]))},this.merge=function(t,r){return r?t.reduce((t,e,n)=>i.add(t,e,r[n]),{}):{}},this.empty=function(e,t){return!(t=t||Object.keys(e)).some(t=>function(t){return null!=t}(e[t]))},this.some=function(e,t){return(t=t||Object.keys(e)).some(t=>e[t])},this.falsy=function(t,e){return!i.some(t,e)},this.init=function(e,n,t){return(t=t||Object.keys(n)).forEach(t=>{e[t]=e[t]??n[t]}),i},this.clone=function(t){return Object.assign({},t)},this.deepClone=function(t){let e={};for(var n in t)Array.isArray(t[n])?e[n]=t[n].slice():"object"==typeof t[n]?e[n]=i.deepClone(t[n]):e[n]=t[n];return e},this.clear=function(t){for(var e in t)delete t[e];return i},this.deepClear=function(t){for(var e in t)Array.isArray(t[e])?t[e].splice(0):"object"==typeof t[e]&&i.deepClear(t[e]),delete t[e];return i}}function StringBox(){const s=this,e=/"|'|&|<|>|\\/g,n={'"':"&#34;","'":"&#39;","&":"&#38;","<":"&#60;",">":"&#62;","\\":"&#92;"};function r(t){return"string"==typeof t||t instanceof String}function a(t){return r(t)?t.trim():t}function o(t){return t?t.length:0}function i(t){for(var e="",n=o(a(t)),r=0;r<n;r++){var i=t.charAt(r),s="àáâãäåāăąÀÁÂÃÄÅĀĂĄÆßèéêëēĕėęěÈÉĒĔĖĘĚìíîïìĩīĭÌÍÎÏÌĨĪĬòóôõöōŏőøÒÓÔÕÖŌŎŐØùúûüũūŭůÙÚÛÜŨŪŬŮçÇñÑþÐŔŕÿÝ".indexOf(i);e+=s<0?i:"aaaaaaaaaAAAAAAAAAABeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIoooooooooOOOOOOOOOuuuuuuuuUUUUUUUUcCnNdDRryY".charAt(s)}return e.toLowerCase()}this.isset=function(t){return null!=t},this.isstr=r,this.trim=a,this.size=o,this.eq=function(t,e){return i(t)==i(e)},this.iiOf=function(t,e){return i(t).indexOf(i(e))},this.substr=function(t,e,n){return t&&t.substr(e,n)},this.indexOf=function(t,e){return t?t.indexOf(e):-1},this.lastIndexOf=function(t,e){return t?t.lastIndexOf(e):-1},this.prevIndexOf=function(t,e,n){return t?t.substr(0,n).lastIndexOf(e):-1},this.starts=function(t,e){return t&&t.startsWith(e)},this.ends=function(t,e){return t&&t.endsWith(e)},this.prefix=function(t,e){return s.starts(t,e)?t:e+t},this.suffix=function(t,e){return s.ends(t,e)?t:t+e},this.trunc=function(t,e){return o(t)>e?t.substr(0,e).trim()+"...":t},this.itrunc=function(t,e){var n=o(t)>e?s.prevIndexOf(t," ",e):-1;return s.trunc(t,n<0?e:n)},this.escape=function(t){return t&&t.replace(e,t=>n[t])},this.unescape=function(t){return t&&t.replace(/&#(\d+);/g,(t,e)=>String.fromCharCode(e))},this.removeAt=function(t,e,n){return e<0?t:t.substr(0,e)+t.substr(e+n)},this.insertAt=function(t,e,n){return t?t.substr(0,n)+e+t.substr(n):e},this.replaceAt=function(t,e,n,r){return n<0?t:t.substr(0,n)+e+t.substr(n+r)},this.replaceLast=function(t,e,n){return t?s.replaceAt(t,n,t.lastIndexOf(e),e.length):n},this.wrapAt=function(t,e,n,r,i){return e<0?t:s.insertAt(s.insertAt(t,r,e),i,e+r.length+n)},this.iwrap=function(t,e,n,r){return e&&s.wrapAt(t,s.iiOf(t,e),e.length,n||"<u><b>",r||"</b></u>")},this.rand=function(t){return Math.random().toString(36).substr(2,t||8)},this.lopd=function(t){return t&&"***"+t.substr(3,4)+"**"},this.toDate=function(t){return t?new Date(t):null},this.split=function(t,e){return t?t.trim().split(e||","):[]},this.minify=function(t){return t&&t.trim().replace(/\s{2}/g,"")},this.lines=function(t){return s.split(t,/[\n\r]+/)},this.words=function(t){return s.split(t,/\s+/)},this.ilike=function(t,e){return-1<s.iiOf(t,e)},this.olike=function(e,t,n){return t.some(function(t){return s.ilike(e[t],n)})},this.alike=function(e,n,t){return s.words(t).some(function(t){return s.olike(e,n,t)})},this.between=function(t,e,n){return n=n??t,(e=e??t)<=t&&t<=n},this.ltr=function(t,e){for(var n=[],r=o(t);e<r;r-=e)n.unshift(t.substr(r-e,e));return 0<r&&n.unshift(t.substr(0,r)),n},this.rtl=function(t,e){for(var n=[],r=o(t),i=0;i<r;i+=e)n.push(t.substr(i,e));return n},this.slices=function(e,n){var r=0,i=[],s=o(e);for(let t=0;r<s&&t<n.length;t++){var a=n[t];i.push(e.substr(r,a)),r+=a}return r<s&&i.push(e.substr(r)),i}}function TreeBox(){const u=this;var s,a,o;function l(){return!0}function c(t,e){return t.push(e),e}function f(t,e,n){e={id:n,data:e,childnodes:[]};return e.level=t.level+1,o(t,e)?c(t.childnodes,e):null}this.preorder=function(t,e,n){return function e(n,r,i,s){var a=r.childnodes.length;for(let t=0;t<a;t++){var o=r.childnodes[t];i(n,r,o,t)&&e(n,o,i,s),t=s(n,r,o,t)?t:a}return u}(t,t,e,n||l)},this.resume=function(e,t){o=t||l;var n,r=e.length,i=[];0<r&&(n=c(i,e[0]));for(let t=1;t<r;t++){var s=e[t];o(n,s,t,i)&&(n=c(i,s))}return i},this.group=function(t,e,n){return n=Object.assign({id:0,level:0,childnodes:[]},n),o=n.onGroup||l,(n.data=t).forEach(function(r,t){var i=n;e.forEach(function(e,t){var n=r[e];i=i.childnodes.find(t=>t.id==n)||f(i,i.data.filter(t=>t[e]==n),n)||i})}),n},this.tree=function(e,n){return n=Object.assign({id:0,level:0,childnodes:[]},n),s=n.pk||"id",a=n.fk||"parent",o=n.onGroup||l,n.data=e.filter(t=>!t[a]),n.data.forEach(t=>function e(n,t,r){var i=f(t,n.filter(t=>t[a]==r),r);return i&&i.data.forEach(t=>e(n,i,t[s])),i}(e,n,t[s])),n}}const ab=new ArrayBox,dt=new DateBox,gb=new GraphBox,nb=new NumberBox,ob=new ObjectBox,sb=new StringBox,tb=new TreeBox,i18n=new I18nBox,js=new JsBox;function ValidatorBox(){const r=this,i={},n={},a="",s=new Date;let o,u,l={},c=0;const e=/"|'|&|<|>|\\/g,f={'"':"&#34;","'":"&#39;","&":"&#38;","<":"&#60;",">":"&#62;","\\":"&#92;"},d=/^\d+$/,h=/^\d+(,\d+)*$/,m=/\w+[^\s@]+@[^\s@]+\.[^\s@]+/,g=/^[\w#@&°!§%;:=\^\/\(\)\?\*\+\~\.\,\-\$]{8,}$/;const v=/^(\d{8})([A-Z])$/,p=/^([ABCDEFGHJKLMNPQRSUVW])(\d{7})([0-9A-J])$/,j=/^[XYZ]\d{7,8}[A-Z]$/;function b(t){return t?t.length:0}function y(t){return t&&t.trim().replace(/\W+/g,a).toUpperCase()}function E(t,e,n){return e<=t&&t<=n}function D(t){return t&&t.replace(e,t=>f[t])}this.unescape=function(t){return t&&t.replace(/&#(\d+);/g,(t,e)=>String.fromCharCode(e))},this.escape=D,this.size=function(t,e,n){return E(b(t),e,n)},this.range=function(t,e,n){return E(parseFloat(t),e,n)},this.regex=function(t,e){try{return e&&t.test(e)}catch(t){}return!1},this.login=function(t){return r.regex(g,t)?t:null},this.digits=function(t){return r.regex(d,t)?t:null},this.idlist=function(t){return r.regex(h,t)?t:null},this.email=function(t){return r.regex(m,t)?t.toLowerCase():null},this.sysdate=function(){return s},this.isDate=function(t){return t&&t.getTime&&!isNaN(t.getTime())},this.toISODateString=function(t){return(t||s).toISOString().substring(0,10)},this.isset=function(t,e,n){return null!=e?e:r.addError(t,n)},this.close=function(t,e,n){return Math.min(Math.max(+t,e),n)},this.idES=function(t){if(t=y(t)){if(r.regex(v,t))return r.dni(t);if(r.regex(p,t))return r.cif(t);if(r.regex(j,t))return r.nie(t)}return null},this.dni=function(t){return"TRWAGMYFPDXBNJZSQVHLCKE".charAt(parseInt(t,10)%23)==t.charAt(8)?t:null},this.cif=function(t){for(var e=t.match(p),n=e[1],r=e[2],i=e[3],s=0,a=0;a<r.length;a++){var o=parseInt(r[a],10);s+=o=a%2==0?(o*=2)<10?o:parseInt(o/10)+o%10:o}var u=0!==(s%=10)?10-s:s,e="JABCDEFGHI".substr(u,1);return(n.match(/[ABEH]/)?i==u:!n.match(/[KPQS]/)&&i==u||i==e)?t:null},this.nie=function(t){var e=t.charAt(0),e="X"==e?0:"Y"==e?1:"Z"==e?2:e;return r.dni(e+t.substr(1))},this.iban=function(t){var e=(t=y(t))&&t.match(/^([A-Z]{2})(\d{2})([A-Z\d]+)$/);if(!e||b(t)!=={AD:24,AE:23,AT:20,AZ:28,BA:20,BE:16,BG:22,BH:22,BR:29,CH:21,CR:22,CY:28,CZ:24,DE:22,DK:18,DO:28,EE:20,ES:24,FI:18,FO:18,FR:27,GB:22,GI:23,GL:18,GR:27,GT:28,HR:21,HU:28,IE:22,IL:23,IS:26,IT:27,JO:30,KW:30,KZ:20,LB:28,LI:21,LT:20,LU:20,LV:21,MC:27,MD:24,ME:22,MK:19,MR:27,MT:31,MU:30,NL:18,NO:15,PK:24,PL:28,PS:29,PT:25,QA:29,RO:24,RS:22,SA:24,SE:24,SI:19,SK:24,SM:27,TN:24,TR:26,AL:28,BY:28,EG:29,GE:22,IQ:23,LC:32,SC:31,ST:25,SV:28,TL:23,UA:29,VA:22,VG:24,XK:20}[e[1]])return null;let n=(e[3]+e[1]+e[2]).replace(/[A-Z]/g,t=>t.charCodeAt(0)-55);var r;a;let i=n.toString(),s=i.slice(0,2);for(let t=2;t<i.length;t+=7)r=s+i.substring(t,t+7),s=parseInt(r,10)%97;return 1===s?t:null},this.creditCardNumber=function(n){if(16!=b(n=y(n)))return null;let r=0,i=!1;for(let e=15;0<=e;e--){let t=+n[e];i&&(t*=2,t-=9<t?9:0),r+=t,i=!i}return r%10==0?n:null},this.generatePassword=function(t,e){return e=e||"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_#@&°!§%;:=^/()?*+~.,-$",Array.apply(null,Array(t||10)).map(function(){return e.charAt(Math.random()*e.length)}).join(a)},this.testPassword=function(t){var e=0;return e+=/[A-Z]+/.test(t)?1:0,e+=/[a-z]+/.test(t)?1:0,e+=/[0-9]+/.test(t)?1:0,e+=/[\W]+/.test(t)?1:0,e+=2<e&&8<b(t)},this.get=function(t){return r[t]},this.set=function(t,e){return r[t]=e,r},this.getI18n=function(){return u},this.setI18n=function(t){return u=t,r},this.clear=function(t){for(var e in t)delete t[e];return r},this.getMsgs=function(){return i},this.getMsg=function(t){return i[t]},this.setMsg=function(t,e){return i[t]=e,r},this.getMsgOk=function(){return i.msgOk},this.setMsgOk=function(t){return i.msgOk=t,r},this.getMsgInfo=function(){return i.msgInfo},this.setMsgInfo=function(t){return i.msgInfo=t,r},this.getMsgWarn=function(){return i.msgWarn},this.setMsgWarn=function(t){return i.msgWarn=t,r},this.getMsgError=function(){return i.msgError},this.setError=function(t,e){return c++,r.setMsg(t,e)},this.addError=function(t,e){return r.setError(t,e),null},this.setMsgError=function(t){return r.setError("msgError",t)},this.closeMsgs=function(t){return r.setMsgError(t).getMsgs()},this.getForm=function(t){return n[t]},this.setForm=function(t,e){return n[t]=e,r},this.getFields=function(t){t=r.getForm(t);return t?Object.keys(t):[]},this.getData=function(t){return t?o[t]:o},this.getInput=function(t){return l[t]},this.setInput=function(t,e){return l[t]=(e=e)&&e.trim(),r},this.getInputs=function(){return l},this.setInputs=function(t){return l=t,r},this.init=function(t,e){return r.setInputs(t).setI18n(e)},this.validate=function(t){o={},c=0,s.setTime(Date.now());let e=r.clear(i).getForm(t);for(var n in e){let t=e[n];o[n]=t(n,D(l[n]),u)}return!(!e||0<c)&&(!e.onValid||e.onValid(o))}}js.ready(function(){var t=js.getLang();const n=i18n.setI18n(t).getLang();valid.setI18n(n);let e=js.getAll("div.alert"),r=js.getAll(".alert-text");function i(t){js.fadeIn(t.parentNode,"grid")}function s(t,e){t.innerHTML=e,i(t)}function a(t){t&&s(r[0],t)}function o(t){t&&s(r[3],t)}js.each(t=>{t.firstChild&&i(t)},r).load(".alert-close").click(t=>js.fadeOut(t.parentNode));let u=document.querySelector(".loading");function l(){js.show(u).closeAlerts()}function c(){js.fadeOut(u)}const f="input-error",d=".msg-error";js.showOk=function(t){return a(t),js},js.showInfo=function(t){return(t=t)&&s(r[1],t),js},js.showWarn=function(t){return(t=t)&&s(r[2],t),js},js.showError=function(t){return o(t),js},js.closeAlerts=function(){return js.hide(e)},js.showAlerts=function(t){return t?js.showOk(t.msgOk).showInfo(t.msgInfo).showWarn(t.msgWarn).showError(t.msgError):js},js.clean=function(t){return js.closeAlerts().set(t).focus().removeClass(f).set(js.siblings(d)).text("")},js.showErrors=function(t,n){return js.showAlerts(n).set(t).reverse(t=>{var e=t.name&&n[t.name];e&&js.set(t).focus().addClass(f).html(e,js.siblings(d))})},js.ajax=function(t,e,n){return l(),js.fetch({action:t,resolve:e||a,reject:n||o}).catch(o).finally(c)},js.autocomplete=function(r){let n=!1;function t(){return!1}function i(t){return js.siblings("[type=hidden]",t)}return(r=r||{}).action=r.action||"#",r.minLength=r.minLength||3,r.delay=r.delay||500,r.open=r.open||t,r.focus=r.focus||t,r.load=r.load||t,r.remove=r.remove||t,r.render=r.render||function(){return"-"},r.search=function(t,e){return n},r.select=function(t,e){return r.load(e.item,this,i(this)),!1},r.source=function(n,e){this.element.autocomplete("instance")._renderItem=function(t,e){e=sb.iwrap(r.render(e),n.term);return $("<li>").append("<div>"+e+"</div>").appendTo(t)},js.ajax(r.action+"?term="+n.term,t=>e(t.slice(0,10)))},r.change=function(t,e){e.item||(js.val("",this).val("",i(this)),r.remove(this))},$(r.inputs).autocomplete(r),js.set(r.inputs).keydown((t,e)=>{n=8==e.keyCode||sb.between(e.keyCode,46,111)||sb.between(e.keyCode,160,223)})},valid.validateForm=function(t,e){return js.clean(t.elements),js.each(t=>{valid.setInput(t.name,t.value)},t.elements),!!valid.validate(t.getAttribute("action"))||(e.preventDefault(),!js.showErrors(t.elements,valid.closeMsgs(n.errForm)))},valid.submit=function(e,n,r,i){if(valid.validateForm(e,n)){l(),n.preventDefault();let t=new FormData(e);for(var s in valid.getInputs())t.has(s)||t.append(s,valid.getInput(s));js.fetch({method:e.method,action:r||e.action,body:"multipart/form-data"===e.enctype?t:new URLSearchParams(t),reject:function(t){js.showErrors(e.elements,t)},resolve:i||a}).catch(o).finally(c)}return valid}});const valid=new ValidatorBox;valid.set("required",function(t,e,n){return valid.size(e,1,200)?e:valid.addError(t,n.errRequired)}).set("required50",function(t,e,n){return valid.size(e,1,50)?e:valid.addError(t,n.errRequired)}).set("required800",function(t,e,n){return valid.size(e,1,800)?e:valid.addError(t,n.errRequired)}).set("min8",function(t,e,n){return valid.size(e,8,200)?e:valid.addError(t,n.errMinlength8)}).set("max50",function(t,e,n){return valid.size(e,0,50)?e:valid.addError(t,n.errMaxlength)}).set("max200",function(t,e,n){return valid.size(e,0,200)?e:valid.addError(t,n.errMaxlength)}).set("max800",function(t,e,n){return valid.size(e,0,800)?e:valid.addError(t,n.errMaxlength)}).set("token",function(t,e,n){return valid.size(e,200,800)?e:valid.addError(t,n.errRegex)}).set("usuario",function(t,e,n){return valid.min8(t,e,n)&&(valid.idES(e)||valid.email(e)||valid.addError(t,n.errRegex))}).set("clave",function(t,e,n){return valid.min8(t,e,n)&&(valid.login(e)||valid.addError(t,n.errRegex))}).set("reclave",function(t,e,n){return valid.clave(t,e,n)&&(e==valid.getData("clave")?e:valid.addError(t,n.errReclave))}).set("nif",function(t,e,n){return valid.required(t,e,n)&&(valid.idES(e)||valid.addError(t,n.errNif))}).set("correo",function(t,e,n){return valid.required(t,e,n)&&(valid.email(e)||valid.addError(t,n.errCorreo))}).set("dtval",function(t,e,n){e=e&&new Date(e);return valid.isDate(e)?e:valid.addError(t,n.errDate)}).set("dateval",function(t,e,n){return n.toDate(e)||valid.addError(t,n.errDate)}).set("dtnull",function(t,e,n){return e?new Date(e):null}).set("datenull",function(t,e,n){return n.toDate(e)}).set("ltNow",function(t,e,n){let r=valid.required(t,e,n)&&valid.dateval(t,e,n);return r&&r.getTime()<Date.now()?r:valid.addError(t,n.errDateLe)}).set("leToday",function(t,e,n){e=valid.required(t,e,n)&&valid.dateval(t,e,n);return e&&valid.toISODateString(e)<=valid.toISODateString()?e:valid.addError(t,n.errDateLe)}).set("gtNow",function(t,e,n){let r=valid.required(t,e,n)&&valid.dateval(t,e,n);return r&&r.getTime()>Date.now()?r:valid.addError(t,n.errDateGe)}).set("geToday",function(t,e,n){e=valid.required(t,e,n)&&valid.dateval(t,e,n);return e&&valid.toISODateString(e)>=valid.toISODateString()?e:valid.addError(t,n.errDateGe)}).set("intval",function(t,e,n){return valid.isset(t,n.toInt(e),n.errNumber)}).set("intnull",function(t,e,n){return n.toInt(e)}).set("floatval",function(t,e,n){return valid.isset(t,n.toFloat(e),n.errNumber)}).set("floatnull",function(t,e,n){return n.toFloat(e)}).set("key",function(t,e,n){e=n.toInt(e);return null===e||0<e?e:valid.addError(t,n.errGt0)}).set("gt0",function(t,e,n){e=valid.required(t,e,n)&&valid.floatval(t,e,n);return 0<e?e:valid.addError(t,n.errGt0)}),js.ready(function(){const a=i18n.getLang();"undefined"!=typeof grecaptcha&&grecaptcha.ready(function(){js.load(".captcha").click((e,n)=>{grecaptcha.execute("6LeDFNMZAAAAAKssrm7yGbifVaQiy1jwfN8zECZZ",{action:"submit"}).then(t=>valid.setInput("token",t).submit(e.closest("form"),n)).catch(js.showError),n.preventDefault()})}),js.load("select").val(),js.setI18n(a).load("form").reverse(n=>{let r=n.elements;js.set(js.filter(".integer",r)).change(t=>{t.value=a.fmtInt(t.value)}),js.set(js.filter(".float",r)).change(t=>{t.value=a.fmtFloat(t.value)}),js.set(js.filter(".date-range",r)).each((t,e,n)=>{js.change(t,()=>js.set(js.filter(".min-"+t.id,n)).attr("max",t.value)),js.change(t,()=>js.set(js.filter(".max-"+t.id,n)).attr("min",t.value))});let e=js.filter("textarea[maxlength]",r);function i(t){var e=Math.abs(t.getAttribute("maxlength")-sb.size(t.value));js.text(e,n.querySelector("#counter-"+t.id))}function s(t,e){return!js.set(js.next("i",t)).setClass(e)}js.set(e).keyup(i).each(i),js.autocomplete({inputs:js.filter(".ac-user",r),action:"/user/find.html",render:function(t){return t.nif+" - "+(t.nm+" "+t.ap1+" "+t.ap2).trim()},load:function(t,e,n){js.val(this.render(t),e).val(t.nif,n)}}).autocomplete({inputs:js.filter(".ac-menu",r),action:"/menu/find.html",focus:function(t,e){return s(this,"input-item input-icon "+(e.item&&e.item.icon||"fas fa-arrow-alt-circle-up"))},remove:function(t){s(t,"input-item input-icon fas fa-arrow-alt-circle-up")},render:function(t){return(t.icon?'<i class="'+t.icon+'"></i> - ':"")+a.get(t,"nm")},load:function(t,e,n){js.val(a.get(t,"nm"),e).val(t.id,n)}}),js.set(js.filter(".update-icon",r)).change(t=>{js.setClass("input-item input-icon "+(t.value||"far fa-window-close"),t.nextElementSibling)}),js.set(js.filter("[type=reset]",r)).click(()=>{n.reset(),js.clean(r).each(i,e)}).set(js.filter(".clear-all",r)).click(()=>{js.val("",r).clean(r).each(i,e)}).load("a.nav-to",n).click((t,e)=>{js.ajax(t.href,t=>{js.showAlerts(t).import(r,t).trigger(r,"change")}),e.preventDefault()}).load("a.duplicate",n).click((t,e)=>{valid.submit(n,e,t.href,t=>{js.showAlerts(t).import(r,t).load("a.remove,a.nav-to",n).hide()})}).load("a.remove",n).click((t,e)=>{confirm(a.remove)||e.preventDefault()}),js.focus(r),n.addEventListener("submit",t=>{n.classList.contains("ajax")?valid.submit(n,t,null,t=>js.showAlerts(t).import(r,t).clean(r).each(i,e)):n.classList.contains("ajax-clear")?valid.submit(n,t,null,t=>js.showAlerts(t).val("",r).clean(r).each(i,e)):valid.validateForm(n,t)})})}),js.ready(function(){const d=i18n.getLang();js.getAll("table").forEach(r=>{let n=js.prev("form",r)[0],e=js.next(".pagination",r)[0],i=js.getAll("a.sort",r.thead),s=r.tBodies[0],a=r.tBodies[1],o=null;function u(t,e){e.preventDefault(),o=t.closest("tr"),js.ajax(t.href,t=>js.import(n.elements,t))}function l(n,t){if(confirm(d.remove)){if(e&&1==s.children.length)return!0;js.ajax(n.href,t=>{n.closest("tr").remove();var e=s.children.length;e||js.removeClass("hide",a),js.load("#rows",r.tfoot).text(e).load("#size",r.tfoot).text(t.size||e).showAlerts(t)})}t.preventDefault()}function c(t){js.html(t,s).load("a.edit",s).click(u).load("a.remove",s).click(l)}function f(t,e){var n=js.set(t).hasClass("asc")?"desc":"asc";js.removeClass("asc desc",i).addClass(n),js.ajax(t.href+"&dir="+n,c),e.preventDefault()}if(js.click(f,i).load(".name-sort",r.thead).click((t,e)=>f(t.nextElementSibling,e)).load("a.edit",s).click(u).load("a.remove",s).click(l),s.children.length||js.removeClass("hide",a),n&&(n.removeEventListener("submit"),n.addEventListener("submit",t=>{valid.submit(n,t,null,t=>{var e=n.elements;js.showAlerts(t).val("",e).clean(e).html(t.html,o).load("a.edit",o).click(u)})})),e){let r=js.getAll("input[type=range]",e);js.set(r).change((t,e)=>{var n=t.dataset.basename+"/pages.html?page=0&psize="+t.value;js.val(t.value,r).ajax(n,c),t.title=t.value}),js.load("a",e).click((t,e)=>{js.ajax(t.href,c),e.preventDefault()})}})}),js.ready(function(){js.getAll("ul.menu").forEach(function(e){let t=Array.from(e.children);t.sort((t,e)=>+t.dataset.orden-+e.dataset.orden),t.forEach(n=>{e.appendChild(n);var t=n.dataset.mask;8==(8&t)&&(n.innerHTML+='<ul class="sub-menu"></ul>',n.firstElementChild.innerHTML+='<b class="nav-tri">&rtrif;</b>',js.set(n.firstElementChild).click((t,e)=>{js.toggle("active",n),e.preventDefault()})),0==(4&t)&&js.addClass("disabled",n.firstElementChild)});for(let t=0;t<e.children.length;){var n=e.children[t],r=n.dataset.padre;if(r){let t=js.get("li[id='"+r+"']",e);t&&t.lastElementChild.appendChild(n)}else t++}js.fadeIn(e.children)}),js.load(".sidebar-toggle").click((t,e)=>{js.toggle("hide",js.getAll(".sidebar-icon",t.parentNode)),js.toggle("active",js.get("#sidebar",t.parentNode)),e.preventDefault()});let t=js.get("#back-to-top");js.click(()=>{js.scrollTop(400)},t),window.onscroll=function(){80<window.pageYOffset?js.fadeIn(t):js.fadeOut(t)},window.addEventListener("unload",function(t){js.ajax("/session/destroy.html")})}),js.ready(function(){let t=document.querySelectorAll("ul#tab-nav li"),e=document.querySelectorAll(".tab-contents"),n=document.querySelectorAll("ul#progressbar li"),r=n.length||e.length,i=0;function s(t){return t<0?0:t<r?t:r-1}function a(){js.removeClass("active",t).addClass("active",t[i]),js.removeClass("active",e).addClass("active",e[i]),n.forEach((t,e)=>js.set(t).toggle("active",e<=i))}js.load(".prev-tab").click(()=>(i=s(i-1),a())),js.load(".next-tab").click(()=>(i=s(i+1),a()));var o=js.getAll("a[href^='#']");js.set(js.filter("[href^='#tab-']",o)).click(t=>(i=s(+t.href.substr(t.href.lastIndexOf("-")+1)-1),a())),js.set(js.filter(":not([href^='#tab-'])",o)).click((e,t)=>{try{let t=document.querySelector(e.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth"})}catch(t){}t.preventDefault()}),js.load("a.show-info").click((t,e)=>{js.set(t.lastElementChild).toggle("fa-angle-double-up fa-angle-double-down").load(".extra-info-"+t.id).toggle("hide"),e.preventDefault()})}),valid.setForm("/login.html",{usuario:valid.usuario,clave:valid.clave}).setForm("/contact.html",{nm:valid.required,correo:valid.correo,asunto:valid.required,info:valid.required}).setForm("/signup.html",{token:valid.token,nm:valid.required,ap1:valid.required,nif:valid.nif,correo:valid.correo}).setForm("/reactive.html",{token:valid.token,correo:valid.correo}),valid.setForm("/user/pass.html",{oldPass:valid.min8,clave:valid.min8,reclave:valid.reclave}).setForm("/user/profile.html",{nm:valid.required,ap1:valid.required,ap2:valid.max200,nif:valid.nif,correo:valid.correo});const MENU_SAVE={id:valid.key,ico:valid.max50,nm:valid.required,nm_en:valid.max200,pn:valid.max200,padre:function(t,e,n){var r=valid.getData("id"),e=n.toInt(e);return sb.isset(r)&&sb.isset(e)&&r==e&&valid.setError("pn",n.errRefCircular),e},orden:valid.intval,mask:valid.intval,alta:valid.ltNow},MENU_FILTER={fn:valid.max200,n1:valid.intnull,n2:valid.intnull,d1:valid.dtnull,d2:valid.dtnull};valid.setForm("/menu/save.html",MENU_SAVE).setForm("/menu/duplicate.html",MENU_SAVE),valid.setForm("/menu/filter.html",MENU_FILTER).setForm("/menu/search.html",MENU_FILTER),js.ready(function(){const t=i18n.getLang(),e=$("#f1").on("change",function(){n.datepicker("option","minDate",t.toDate(this.value))}),n=$("#f2").on("change",function(){e.datepicker("option","maxDate",t.toDate(this.value))})}),valid.setForm("/tests/email.html",{nombre:valid.required,correo:valid.correo,date:valid.datenull,number:valid.gt0,asunto:valid.required,info:valid.required800});